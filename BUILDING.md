# Building with CMake

## Dependencies

For a list of dependencies, please refer to [conanfile.py](conanfile.py).

## Build

### Installing dependencies 
If it is your first time using Conan, first install [Conan2](https://docs.conan.io/2/installation.html).

You may need to make Conan to generate a profile:
```
conan profile detect
```

Note that you may need to edit the autogenerated file's compiler standard (compiler.cppstd) to C++23, which this project uses.

Then run this command to get the project dependencies for release:
```sh
conan install . -s build_type=Release -b missing
```

### Building
Here are the steps for building in release mode with a single-configuration
generator, like the Unix Makefiles one, using Conan's toolchain:

```sh
cmake -S . -B build -D CMAKE_BUILD_TYPE=Release -D CMAKE_TOOLCHAIN_FILE=conan/conan_toolchain.cmake
cmake --build build
```

Here are the steps for building in release mode with a multi-configuration
generator, like the Visual Studio ones:

```sh
cmake -S . -B build -D CMAKE_TOOLCHAIN_FILE=conan/conan_toolchain.cmake
cmake --build build --config Release
```

The `parallel-noise-reduction` execution will then be in `build/`.

### Building with MSVC

Note that MSVC by default is not standards compliant and you need to pass some
flags to make it behave properly. See the `flags-msvc` preset in the
[CMakePresets.json](CMakePresets.json) file for the flags and with what
variable to provide them to CMake during configuration.

### Building on Apple Silicon

CMake supports building on Apple Silicon properly since 3.20.1. Make sure you
have the [latest version][1] installed.

## Install

This project doesn't require any special command-line flags to install to keep
things simple. As a prerequisite, the project has to be built with the above
commands already.

The below commands require at least CMake 3.15 to run, because that is the
version in which [Install a Project][2] was added.

Here is the command for installing the release mode artifacts with a
single-configuration generator, like the Unix Makefiles one:

```sh
cmake --install build
```

Here is the command for installing the release mode artifacts with a
multi-configuration generator, like the Visual Studio ones:

```sh
cmake --install build --config Release
```

[1]: https://cmake.org/download/
[2]: https://cmake.org/cmake/help/latest/manual/cmake.1.html#install-a-project
